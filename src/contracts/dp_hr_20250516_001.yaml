data_product: dp_hr_20250516_001
description: >
  Headcount data by department and division for SAP employees.
tables:
  - name: Employees
    columns:
      - name: employee_id
        type: string
      - name: department_id
        type: string
      - name: division_id
        type: string
      - name: hire_date
        type: date
  - name: Departments
    columns:
      - name: department_id
        type: string
      - name: department_name
        type: string
  - name: Divisions
    columns:
      - name: division_id
        type: string
      - name: division_name
        type: string
relationships:
  - from_table: Employees
    from_column: department_id
    to_table: Departments
    to_column: department_id
  - from_table: Employees
    from_column: division_id
    to_table: Divisions
    to_column: division_id
kpis:
  - name: Headcount
    description: Number of employees per department/division
    calculation: COUNT(employee_id)
    aggregation: COUNT
    base_column: employee_id
    join_tables: []
    dependencies: null
    sql_example: |
      SELECT department_id, division_id, COUNT(employee_id) AS headcount
      FROM Employees
      GROUP BY department_id, division_id
